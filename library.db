import sqlite3

# Initialize database and tables
conn = sqlite3.connect('library.db')
cursor = conn.cursor()

# Create books table
cursor.execute('''CREATE TABLE IF NOT EXISTS books (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title TEXT NOT NULL,
    author TEXT NOT NULL,
    available INTEGER DEFAULT 1
)''')

# Create borrowers table
cursor.execute('''CREATE TABLE IF NOT EXISTS borrowers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER,
    username TEXT,
    book_id INTEGER,
    borrowed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)''')

# Insert sample books
books = [
    ('To Kill a Mockingbird', 'Harper Lee'),
    ('1984', 'George Orwell'),
    ('Pride and Prejudice', 'Jane Austen'),
    ('The Great Gatsby', 'F. Scott Fitzgerald')
]

# To avoid inserting duplicates
existing_titles = [row[0] for row in cursor.execute("SELECT title FROM books").fetchall()]
for book in books:
    if book[0] not in existing_titles:
        cursor.execute('INSERT INTO books (title, author) VALUES (?, ?)', book)

conn.commit()
conn.close()
